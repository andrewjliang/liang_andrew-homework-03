---
title: "ENV S 193DS - Homework 3"
author: "Andrew Liang"
date: now
format: pdf
editor: visual
toc: true 
warning: false 
message: false 
---

## Link to Forked Repository: https://github.com/andrewjliang/liang_andrew-homework-03

# Setup

```{r}
rm(list = ls())
getwd()

library(tidyverse)
library(readxl)
library(here)
library(janitor)
library(GGally)
library(MuMIn)
library(ggeffects)
library(gtsummary)
library(flextable)
library(modelsummary)

drought_exp <- read_xlsx(path = here("data", 
                                     "Valliere_etal_EcoApps_Data.xlsx"),
                         sheet = "First Harvest")

drought_exp_clean <- drought_exp %>% 
  clean_names() %>% # nicer column names
  mutate(species_name = case_when( # adding column with species scientific names
    species == "ENCCAL" ~ "Encelia californica", # bush sunflower
    species == "ESCCAL" ~ "Eschscholzia californica", # California poppy
    species == "PENCEN" ~ "Penstemon centranthifolius", # Scarlet bugler
    species == "GRICAM" ~ "Grindelia camporum", # great valley gumweed
    species == "SALLEU" ~ "Salvia leucophylla", # Purple sage
    species == "STIPUL" ~ "Nasella pulchra", # Purple needlegrass
    species == "LOTSCO" ~ "Acmispon glaber" # deerweed
  )) %>% 
  relocate(species_name, .after = species) %>% # moving species_name column after species
  mutate(water_treatment = case_when( # adding column with full treatment names
    water == "WW" ~ "Well-Watered",
    water == "DS" ~ "Drought-Stressed"
  )) %>% 
  relocate(water_treatment, .after = water) # moving water_treatment column after water
```

# Problem 1. Multiple Linear Regression: Model Selection and Construction

## a. Table

```{r}
model0 <- lm(total_g ~ 1, # formula
             data = drought_exp_clean) # data frame
model1 <- lm(total_g ~ sla + water_treatment + species_name,
             data = drought_exp_clean)
model2 <- lm(total_g ~ sla + water_treatment,
             data = drought_exp_clean)
model3 <- lm(total_g ~ sla + species_name,
             data = drought_exp_clean)
model4 <- lm(total_g ~ water_treatment + species_name, drought_exp_clean)

modelsummary::modelsummary( # this function takes a list of models
  list( 
    "null" = model0, # "model name" = model object
    "model 1" = model1,
    "model 2" = model2,
    "model 3" = model3,
    "model 4" = model4
  )
)
```

## b. Statistical Methods

```{r fig.width = 12, fig.height = 6, out.width = "90%", fig.align = "center"}
model.sel(model0,
          model1, 
          model2, 
          model3,
          model4)

par(mfrow = c(2, 2))
plot(model4)
```

We attempted to determine the relationship between the mass of the

In order to choose the most appropriate model, I looked at the Akaike Information Criterion and delta levels for each model. We found that the fifth model was the most appropriate model because it has the lowest AIC and delta AIC. After checking the conditions for linearity (graphs shown above), we found that the assumptions for the multiple linear regression model (no heteroskedasticity,

## c.

```{r}

geom

ggpredict(model4) %>%
  plot(show_data = T)
```

## d.

## e.

# Problem 2 - Affective Visualization

## a.

*My thought for an affective visualization for my data would include some sort of reference to sleep or trying to get on the bus. The main reason I may have trouble getting on the bus is oversleeping or taking too long to prepare for the day, so I believe that a visualization showing the consequences of doing so would be appropriate for my data. Because my dependent variable is binary (whether I got on the bus), I could create a "road" with the observations that I could include a "bus" on for my art.*

## b. 

![](images/Draft-2.jpg)

## c.

```{r}
setwd("/Users/andrewliang/Desktop/andrew/ENVS-193DS/busdata")
busdata <- read_csv("BusData.csv") %>%
  clean_names()
view(busdata)

busdata %>%
  ggplot(aes(x = got_on_bus, y = difference_in_wake_up_time_minutes, shape = got_on_bus, color = got_on_bus)) +
  geom_point(position = position_jitter(width = 0.05), na.rm = T) +
  labs(title = "Later Wake-Up Times Increase Chances of Missing the Bus", x = "Did Andrew Catch the Bus?", y = "Difference Between Alarm and Wake-Up Time (min)") +
  theme(text = element_text(size = 13, family = "serif"), 
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank(),
        panel.background = element_blank(), 
        axis.line = element_line(colour = "black"), 
        plot.title = element_text(hjust=0.5),
        legend.title = element_blank(),
        legend.position = "none") + 
  guides(fill=guide_legend(title="Got on Bus"))
```

## d.

*The Sleeping Man*

*College students often struggle to wake up on time to catch the bus, especially for classes at 8:00 or 9:00 AM. Similarly, a lot of people take the bus to and from school, but find that they may miss the bus by a mere minute because they take too long to prepare for the day or even because the bus arrives a few minutes earlier than usual. Based on these facts, I created a visualization that used the binary nature of my dependent variable to act as a "road" for the "bus." This was based off of the*

# Problem 3 - Statistical Critique

## a.

The authors are using t-tests, linear regression, and difference-in-difference models in order to test their hypotheses.

\![T-Test\](images/Screenshot 2024-04-24 at 11.37.10 PM.png)


\![First Linear Regression Model\](images/Screenshot 2024-04-24 at 11.37.43 PM.png)


\![Second Linear Regression Model\](images/Screenshot 2024-04-24 at 11.38.21 PM.png)


\![Third Linear Regression Model\](images/Screenshot 2024-04-24 at 11.38.56 PM.png)


\![Fourth Linear Regression Model Table\](images/Screenshot 2024-04-24 at 11.42.32 PM.png)


\![Fifth Linear Regression Model\](images/Screenshot 2024-04-24 at 11.42.58 PM.png)


\![Difference-in-Difference Model Results\](images/Screenshot 2024-04-24 at 11.43.52 PM.png)

## b. 

*The authors of the paper were able to visually*

## c.

## d.
